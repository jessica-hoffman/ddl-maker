.txt' AS FILENAME

        ,'LN_CADENCE/Inbound/' AS DIRECTORYPATH

        ,'BCP_OUT' AS BCP_TYPE

        ,'FULL' AS FILE_TYPE

        ,'!|%' AS COLUMN_DELIMITER

        ,'#^' AS ROW_DELIMITER

        ,NULL AS QUOTED_VALUE

        ,'N' AS IS_CUSTOMSQL

        ,NULL AS CUSTOMSQL

        ,'Y' AS IS_ACTIVE

        ,'Y' AS TRUNC_LOAD_IND

        ,SYSDATE() AS INSERT_DTTM

        ,SYSDATE() AS UPDATE_DTTM

        ,'PROVIDER=MSOLEDBSQL;' AS SQLSERVERPROVIDER

        ,'N' AS IS_SECONDARYSERVER

        ,'Y' AS IS_TRUSTEDCONN

        ,'Y' AS APPLICATIONINTENT

        ,'Y' AS MULTISUBNETFAILOVER

        ,'N' AS IS_SENDSUCCESSEMAIL

        ,'-c' AS ENCODING

        ,'N' AS SET_QUOTED_IDENTIFIER

        ,NULL AS TGT_DATABASENAME

        ,NULL AS TGT_SCHEMANAME

        ,NULL AS TGT_TABLENAME

        ,NULL AS PRE_LOAD_TRUNC_IND

        ,NULL AS POST_LOAD_HISTORY_IND

        ,NULL AS HISTORY_LOAD_TYPE

        ,NULL AS FILE_FORMAT_TEMPLATE

        ,'Y' AS S3_UPLOAD

        ,'edp-ingestion-s3' AS S3_BUCKETNAME

        ,'AB_EDP_AWS_S3' AS AWS_S3_CONNECTION_NAME

        ,'Inbound/Datafiles/' AS S3_DATA_FILE_PREFIX

        ,'Inbound/Controlfiles/' AS S3_CONTROL_FILE_PREFIX

        ,'N' AS MULTIPLE_RUNS_DAILY

        ,'Sheet1' AS EXCEL_SHEET

        ,'Y' AS POST_S3_UPLOAD_DEL_IND

    FROM DUAL

) S

ON

(S.APPL_GROUP = T.APPL_GROUP AND S.SERVERNAME = T.SERVERNAME AND S.DATABASENAME = T.DATABASENAME AND S.SCHEMANAME = T.SCHEMANAME AND S.TABLENAME = T.TABLENAME)

WHEN MATCHED THEN

UPDATE SET

     T.FILENAME = S.FILENAME

    ,T.DIRECTORYPATH = S.DIRECTORYPATH

    ,T.UPDATE_DTTM = S.UPDATE_DTTM

 

 

WHEN NOT MATCHED THEN

INSERT (T.CONNECTION_NAME, T.APPL_GROUP, T.SERVERNAME, T.DATABASENAME,          T.SCHEMANAME,                T.TABLENAME,   T.FILENAME,      T.DIRECTORYPATH,          T.BCP_TYPE,       T.FILE_TYPE,                T.COLUMN_DELIMITER, T.ROW_DELIMITER,         T.QUOTED_VALUE,          T.IS_CUSTOMSQL,                T.CUSTOMSQL,  T.IS_ACTIVE,       T.TRUNC_LOAD_IND,      T.INSERT_DTTM,              T.SQLSERVERPROVIDER,                T.IS_SECONDARYSERVER,              T.IS_TRUSTEDCONN,      T.APPLICATIONINTENT,  T.MULTISUBNETFAILOVER,                T.IS_SENDSUCCESSEMAIL,            T.ENCODING,     T.SET_QUOTED_IDENTIFIER,        T.TGT_DATABASENAME,                T.TGT_SCHEMANAME,   T.TGT_TABLENAME,         T.PRE_LOAD_TRUNC_IND,            T.POST_LOAD_HISTORY_IND,                T.HISTORY_LOAD_TYPE, T.FILE_FORMAT_TEMPLATE,        T.S3_UPLOAD,   T.S3_BUCKETNAME,                T.AWS_S3_CONNECTION_NAME,              T.S3_DATA_FILE_PREFIX,               T.S3_CONTROL_FILE_PREFIX,                T.MULTIPLE_RUNS_DAILY,             T.EXCEL_SHEET, T.POST_S3_UPLOAD_DEL_IND )

VALUES (S.CONNECTION_NAME,               S.APPL_GROUP, S.SERVERNAME,               S.DATABASENAME,                S.SCHEMANAME,            S.TABLENAME,  S.FILENAME,      S.DIRECTORYPATH,          S.BCP_TYPE,       S.FILE_TYPE,                S.COLUMN_DELIMITER, S.ROW_DELIMITER,         S.QUOTED_VALUE,          S.IS_CUSTOMSQL,                S.CUSTOMSQL, S.IS_ACTIVE,      S.TRUNC_LOAD_IND,      S.INSERT_DTTM,              S.SQLSERVERPROVIDER,                S.IS_SECONDARYSERVER,             S.IS_TRUSTEDCONN,      S.APPLICATIONINTENT,  S.MULTISUBNETFAILOVER,                S.IS_SENDSUCCESSEMAIL,            S.ENCODING,     S.SET_QUOTED_IDENTIFIER,       S.TGT_DATABASENAME,                S.TGT_SCHEMANAME,   S.TGT_TABLENAME,        S.PRE_LOAD_TRUNC_IND,           S.POST_LOAD_HISTORY_IND,                S.HISTORY_LOAD_TYPE, S.FILE_FORMAT_TEMPLATE,        S.S3_UPLOAD,   S.S3_BUCKETNAME,                S.AWS_S3_CONNECTION_NAME,             S.S3_DATA_FILE_PREFIX,               S.S3_CONTROL_FILE_PREFIX,                S.MULTIPLE_RUNS_DAILY,            S.EXCEL_SHEET, S.POST_S3_UPLOAD_DEL_IND);